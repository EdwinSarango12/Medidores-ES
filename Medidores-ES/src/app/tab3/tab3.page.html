<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>
      <ion-icon name="stats-chart" class="ion-margin-end"></ion-icon>
      Estadísticas
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Información de Consumo -->
  <ion-card class="consumo-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="water" color="primary"></ion-icon>
        Consumo de Agua
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="consumo-info">
        <div class="consumo-total">
          <h2>{{ consumoTotal.toFixed(2) }}</h2>
          <p>m³ Total</p>
        </div>
        <div class="consumo-promedio">
          <h3>{{ consumoPromedio.toFixed(2) }}</h3>
          <p>m³ Promedio</p>
        </div>
      </div>
      <div class="chart-container">
        <canvas #consumoChart></canvas>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Gráfico de Barras -->
  <ion-card class="barras-card">
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="bar-chart" color="primary"></ion-icon>
        Lecturas por Mes
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="chart-container">
        <canvas #barrasChart></canvas>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Información del Usuario -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="person" color="primary"></ion-icon>
        Información del Usuario
      </ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item lines="none">
        <ion-icon name="mail" slot="start" color="medium"></ion-icon>
        <ion-label>
          <h3>Email</h3>
          <p>{{ user?.email || 'N/A' }}</p>
        </ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-icon name="person-circle" slot="start" color="medium"></ion-icon>
        <ion-label>
          <h3>Rol</h3>
          <p>{{ user?.role === 'admin' ? 'Administrador' : 'Medidor' }}</p>
        </ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-icon name="document-text" slot="start" color="medium"></ion-icon>
        <ion-label>
          <h3>Total de Lecturas</h3>
          <p>{{ lecturas.length }}</p>
        </ion-label>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <!-- Botón Cerrar Sesión -->
  <ion-button
    expand="block"
    color="danger"
    (click)="cerrarSesion()"
    class="ion-margin-top"
  >
    <ion-icon name="log-out" slot="start"></ion-icon>
    Cerrar Sesión
  </ion-button>
</ion-content>
